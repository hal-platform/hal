{% extends 'base.kraken.twig' %}
{% import "_partial-form/macros.twig" as form_macros %}

{% set page_title = "Edit Environment: " ~ application.name %}

{% block content %}
    <h1>Edit <strong>{{ application.name }}</strong> Application</h1>

    <div class="form-wrapper">

        {{ form_macros.formErrors(errors) }}

        <form action="" method="post">
            <ul class="form-fields">

                <li>
                    <label for="app-coreid">
                        CORE Application ID
                        <small class="additional">
                            <b>Warning!</b> Changing the CORE ID will also change where data is stored in Consul. This should not be done if any configuration have already been deployed.
                        </small>
                    </label>
                    <input type="numeric" name="core_id" id="app-coreid" maxlength="64" required value="{{ form.core_id }}" class="text-input">
                </li>

                {% if available %}
                <li>
                    <label for="app-repo">
                        HAL Application
                        <small class="additional">
                            Link a HAL application to this Kraken application. Recommended for applications already using HAL 9000.
                        </small>
                    </label>

                    {% if available|length > 10 %}
                        <select class="select-input" name="hal_app" id="app-repo">
                            <option></option>
                            {% for id, repository_name in available %}
                                {% set isSelected = (id == form.hal_app) %}

                                <option value="{{ id }}" {{ isSelected ? ' selected' : '' }}>
                                    {{ repository_name }}
                                </option>
                            {% endfor %}
                        </select>
                    {% else %}
                        <ul class="radio-grid--form">
                            {% for id, repository_name in available %}
                                {% set isSelected = (id == form.hal_app) %}
                                <li>
                                    <input id="app-hal_app-{{ id }}" type="radio" name="hal_app" value="{{ id }}"{{ isSelected ? ' checked' : ''}}>
                                    <label for="app-hal_app-{{ id }}">{{ repository_name }}</label>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </li>
                {% endif %}

                <li>
                    <label for="app-name">
                        Name
                        <small class="additional">
                            Optional when linking to a HAL application.
                        </small>
                    </label>
                    <input type="text" name="name" id="app-name" maxlength="64" value="{{ form.name }}" class="text-input">
                </li>
            </ul>

            <ul class="button-list">
                <li><input class="btn btn--action" type="submit" value="Save Changes"></li>
                <li class="button-list__fixed"><a class="btn btn--secondary" href="{{ urlFor('kraken.application', {application: application.id}) }}">Cancel</a></li>
            </ul>

        </form>
    </div>
{% endblock %}
