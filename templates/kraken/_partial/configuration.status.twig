{% import "_partial/macros.twig" as macros %}

<h2>Configuration Status</h2>
<div class="details-box">
    <dl class="split mbn">
        <dt class="split__title">Status</dt>
        <dd>
            {% if configuration.isSuccess %}
                {{ macros.status_icon('Success', 'success') }}
            {% else %}
                {{ macros.status_icon('Failed', 'error') }}
            {% endif %}
        </dd>

        <dt class="split__title">Consul</dt>
        <dd>
            {% if is_deployed %}
                {{ macros.status('Currently Deployed', 'success', 'tick') }}
            {% else %}
                Not Active
            {% endif %}
        </dd>

        <dt class="split__title">Time</dt>
        <dd>{{ configuration.created|html5date }}</dd>

        <dt class="split__title">Deployed by</dt>
        <dd class="js-build-duration">
            {% if configuration.user %}
                <a href="{{ urlFor('user', {id: configuration.user.id}) }}">{{ configuration.user.handle }}</a>
            {% else %}
                Unknown
            {% endif %}
        </dd>
    </dl>

    <p class="leader--napolean trailer--napolean">
        <small>
        {% if is_deployed %}
            {% if configuration.isSuccess %}
                This snapshot is currently actively deployed.
            {% else %}
                This snapshot is currently actively deployed, but an error occured in the process. It should be redeployed.
            {% endif %}

        {% else %}
            {% if configuration.isSuccess %}
                This snapshot was previously successfully deployed.
            {% else %}
                An error occured while attempting to deploy this configuration. However the snapshot was saved, and it may be redeployed.
            {% endif %}

        {% endif %}
        </small>
    </p>
</div>
