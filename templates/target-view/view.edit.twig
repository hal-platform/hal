{% extends 'base.twig' %}
{% import "macros.form.twig" as form_macros %}

{% set page_title = 'Edit Target View : ' ~ view.name %}

{% block content %}
    <h1>Edit Target View - <b>{{ view.name }}</b></h1>

    <div class="details-box">
        <dl class="split mbn">
            <dt class="split__title">Application</dt>
            <dd>
                <a href="{{ uriFor('application', {'application': application.id}) }}">{{ application.name }}</a>
            </dd>

            <dt class="split__title">Environment</dt>
            <dd>{{ environment.name }}</dd>
        </dl>
    </div>

    <div class="form-wrapper">
        {{ form_macros.formErrors(errors) }}

        <form method="post">
            <ul class="form-fields">

                <li>
                    <h5 class="label">ID</h5>
                    {{ view.id }}
                </li>

                <li>
                    <h5 class="label">Permissions</h5>
                    {% if view.user %}
                        This view is owned by <b>{{ view.user.name }}</b>.
                        <br>Only administrators, leads, and this user can make changes.
                    {% else %}
                        This view is <b>shared</b>.
                        <br>Any user with build permissions can make changes.
                    {% endif %}
                </li>

                <li>
                    <label for="name">Name</label>
                    <input name="name" id="name" maxlength="100" required value="{{ form.name }}" class="text-input">
                </li>
                <li>
                    {% set isChecked = form.shared %}
                    <label for="shared">
                        <input type="checkbox" name="shared" id="shared" value="1"{{ isChecked ? ' checked' : '' }}{{ view.user or not isChecked ? '' : ' disabled' }}> Shared?
                    </label>
                    <small class="additional">
                        If this view is shared, all users with build access to this application will be able to manage this view, including removal permissions. Otherwise, only the owner and administrators will have permission.
                    </small>
                </li>
            </ul>

            <ul class="button-list">
                <li><input class="btn btn--action" type="submit" value="Save Changes"></li>
                <li class="button-list__fixed"><a class="btn btn--secondary" href="{{ uriFor('target_view', {'application': application.id, 'view': view.id}) }}">Cancel</a></li>
            </ul>
        </form>
    </div>

    <p class="leader--andre">Removing this view will also remove any pools and deployments attached to it.</p>
    <p>
        <a class="btn btn--destructive" href="{{ uriFor('target_view.remove', {'application': application.id, 'view': view.id}) }}">Remove View</a>
    </p>

{% endblock %}
