{% extends 'base.twig' %}
{% import "macros.twig" as macros %}

{% set entity_type = 'Unknown Entity' %}
{% if remove.param == 'organization' %}
    {% set entity_type = 'Organization' %}
{% elseif remove.param == 'application' %}
    {% set entity_type = 'Application' %}
{% elseif remove.param == 'target' %}
    {% set entity_type = 'Deployment Target' %}
{% elseif remove.param == 'encrypted' %}
    {% set entity_type = 'Encrypted Property' %}
{% elseif remove.param == 'server' %}
    {% set entity_type = 'Server' %}
{% elseif remove.param == 'environment' %}
    {% set entity_type = 'Environment' %}
{% elseif remove.param == 'credential' %}
    {% set entity_type = 'Credential' %}
{% elseif remove.param == 'token' %}
    {% set entity_type = 'User Token' %}
{% endif %}

{% block content %}
    <h1>
        {% if remove.param %}
            Confirm {{ entity_type }} Removal
        {% else %}
            Confirm Removal
        {% endif %}
    </h1>

    {% if remove.param == 'organization' %}
        {{ block('organization_box') }}

    {% elseif remove.param == 'application' %}
        {{ block('application_box') }}
    {% elseif remove.param == 'target' %}
        {{ block('target_box') }}
    {% elseif remove.param == 'encrypted' %}
        {{ block('encrypted_box') }}

    {% elseif remove.param == 'server' %}
        {{ block('server_box') }}
    {% elseif remove.param == 'environment' %}
        {{ block('environment_box') }}
    {% elseif remove.param == 'credential' %}
        {{ block('credential_box') }}

    {% elseif remove.param == 'token' %}
        {{ block('token_box') }}
    {% endif %}

    <h3>Are you sure?</h3>
    <p>You're about to permanently remove this {{ entity_type }}. Do you want to continue?</p>

    <form class="form-wrapper" method="post">
        <ul>
            <li><input class="btn btn--destructive" type="submit" value="Remove"></li>
            <li>{{ block('cancel_button') }}</li>
        </ul>
    </form>

{% endblock %}

{% block cancel_button %}
    {% if remove.param == 'organization' %}
        <a class="btn" href="{{ uriFor('organization', {'organization': remove.entity.id}) }}">Cancel</a>

    {% elseif remove.param == 'application' %}
        <a class="btn" href="{{ uriFor('application', {'application': remove.entity.id}) }}">Cancel</a>
    {% elseif remove.param == 'target' %}
        <a class="btn" href="{{ uriFor('target', {'target': remove.entity.id, 'application': entities.application.id}) }}">Cancel</a>
    {% elseif remove.param == 'encrypted' %}
        <a class="btn" href="{{ uriFor('encrypted', {'encrypted': remove.entity.id, 'application': entities.application.id}) }}">Cancel</a>

    {% elseif remove.param == 'server' %}
        <a class="btn" href="{{ uriFor('server', {'server': remove.entity.id}) }}">Cancel</a>
    {% elseif remove.param == 'environment' %}
        <a class="btn" href="{{ uriFor('environment', {'environment': remove.entity.id}) }}">Cancel</a>
    {% elseif remove.param == 'credential' %}
        <a class="btn" href="{{ uriFor('admin.credential', {'credential': remove.entity.id}) }}">Cancel</a>

    {% elseif remove.param == 'token' %}
        <a class="btn" href="{{ uriFor('user', {'user': entities.user.id}) }}">Cancel</a>
    {% else %}
        <a class="btn" href="javascript:history.go(-1)">Cancel</a>
    {% endif %}
{% endblock %}

{% block server_box %}
    {% set name_label =  remove.entity.type == 'rsync' ? 'Hostname' : 'Region' %}

    <div class="details-box">
        <ul class="mbn">
            <li>Server Type</li>
            <li>{{ remove.entity.formatHumanType }}</li>

            <li>{{ name_label }}</li>
            <li>{{ remove.entity.type == 'script' ? 'N/A' : remove.entity.name }}</li>

            <li>Environment</li>
            <li>{{ remove.entity.environment.name}}</li>
        </ul>
    </div>

{% endblock %}

{% block environment_box %}
    <div class="details-box">
        <ul class="mbn">
            <li>Name</li>
            <li>{{ remove.entity.name }}</li>

            <li>Is Production Environment?</li>
            <li>{{ remove.entity.isProduction ? 'Yes' : 'No' }}</li>
        </ul>
    </div>
{% endblock %}

{% block credential_box %}
    <div class="details-box">
        <ul class="mbn">
            <li>Name</li>
            <li>{{ remove.entity.name }}</li>

            <li>Type</li>
            <li>
                {% if remove.entity.type == 'aws' %}
                    AWS
                {% elseif remove.entity.type == 'privatekey' %}
                    Private Key
                {% endif %}
            </li>
        </ul>
    </div>
{% endblock %}

{% block organization_box %}
    <div class="details-box">
        <ul class="mbn">
            <li>Identifier</li>
            <li>{{ remove.entity.key }}</li>

            <li>Name</li>
            <li>{{ remove.entity.name }}</li>
        </ul>
    </div>
{% endblock %}

{% block application_box %}
    <div class="details-box">
        <ul>
            <li>Identifier</li>
            <li>{{ remove.entity.key }}</li>

            <li>Name</li>
            <li>{{ remove.entity.name }}</li>

            <li>GitHub Source</li>
            <li>{{ macros.gitsource(remove.entity) }}</li>
        </ul>
    </div>
{% endblock %}

{% block target_box %}
    <div class="details-box">
        <ul>
            <li>Application</li>
            <li>{{ remove.entity.application.name }}</li>

            <li>Environment</li>
            <li>{{ remove.entity.server.environment.name }}</li>

            <li>Name</li>
            <li>{{ remove.entity.name ?: 'None' }}</li>

            <li>Type</li>
            <li>{{ remove.entity.server.formatHumanType() }}</li>
        </ul>
    </div>
{% endblock %}

{% block encrypted_box %}
    <div class="details-box">
        <ul class="mbn">
            <li>Application</li>
            <li>{{ remove.entity.application.name }}</li>

            <li>Environment</li>
            <li>
                {% if remove.entity.environment %}
                    {{ remove.entity.environment.name }}
                {% else %}
                    Global (Available in all environments)
                {% endif %}
            </li>

            <li>Property Name</li>
            <li><code>{{ remove.entity.name }}</code></li>
        </ul>
    </div>
{% endblock %}

{% block token_box %}
    <div class="details-box">
        <ul>
            <li>Name</li>
            <li>{{ remove.entity.label }}</li>
        </ul>
    </div>
{% endblock %}
