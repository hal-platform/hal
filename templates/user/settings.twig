{% extends 'base.twig' %}
{% import 'macros.twig' as macros %}

{% set page_title = 'Settings' %}

{% block breadcrumb_links %}
    <li><a href="{{ uriFor('user', {'user': user.id}) }}">{{ user.name }}</a></li>
{% endblock %}

{% block content %}
    <h2>Hal Preferences</h2>
    {{ block('navigation_pref') }}

    <h2>Personal Access Tokens</h2>
    {{ block('access_tokens') }}

{% endblock %}

{% block navigation_pref %}
    <form method="post">

        {% set is_selected = is_serious_business_mode ? ' checked' : '' %}
        <label class="checkbox-toggle">
            <input type="checkbox" name="seriousbusiness" value="1" {{ is_selected }}>
            <b class="checkbox-toggle--pill"></b>Use <b>Serious Business&trade;</b> mode
        </label>

        <p>
            <small>
                Flavor text such as <b>Hello, Dave</b> and <b>I'm afraid I can't do that</b> will be reduced across the application.
            </small>
        </p>

        <p>
            <button class="btn btn--action" type="submit">Save Preferences</button>
        </p>
    </form>
{% endblock %}

{% block access_tokens %}
    <small>Personal Access Tokens can be used to access the <a href="{{ uriFor('api.index') }}">Hal API</a>.</small>

    {% if tokens %}
        <table class="table--spacing-medium">
            <thead>
                <tr>
                    <th class="t10">ID</th>
                    <th>Name</th>
                    <th>Token Secret</th>
                    <th class="t10"></th>
                </tr>
            </thead>
            <tbody>
                {% for token in tokens %}
                    <tr>
                        <td>{{ token|short_guid }}</td>
                        <td>{{ token.name }}</td>
                        <td><code>{{ token.value }}</code></td>
                        <td class="tr">
                            <a href="{{ uriFor('user.token.remove', {'user': user.id, 'token': token.id}) }}">Revoke</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>You have no personal access tokens saved.</p>
    {% endif %}


    <h3>Add new personal access token</h3>
    <form action="{{ uriFor('user.token.add', {'user': user.id}) }}" method="post">

        <div class="form-wrapper">
            <label for="token-name">Token Name</label>
            <input type="text" class="text-input" name="name" id="token-name" maxlength="50" required>
        </div>

        <p>
            <button class="btn btn--action" type="submit">Generate Token</button>
        </p>

    </form>

{% endblock %}
