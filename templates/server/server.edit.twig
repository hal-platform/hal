{% extends 'base.html.twig' %}
{% import "_partial-form/macros.twig" as form_macros %}

{% set page_title = 'Edit Server : ' ~ server.name %}

{% block content %}
    <h1>Edit Server - <strong>{{ server.name }}</strong></h1>

    <div class="form-wrapper">
        {{ form_macros.formErrors(errors) }}

        <form method="post">
            <ul class="form-fields">
                <li>
                    <label for="servertype">Type</label>
                    <ul class="radio-grid radio-grid--tri">

                        {% set checked = form.server_type == 'rsync' ? ' checked' : '' %}
                        <li>
                            <input id="server_type-rsync" type="radio" name="server_type" value="rsync"{{ checked }}>
                            <label for="server_type-rsync">Internal (Rsync)</label>
                        </li>

                        {% set checked = form.server_type == 'eb' ? ' checked' : '' %}
                        <li>
                            <input id="server_type-eb" type="radio" name="server_type" value="eb"{{ checked }}>
                            <label for="server_type-eb">Elastic Beanstalk</label>
                        </li>

                        {% set checked = form.server_type == 'ec2' ? ' checked' : '' %}
                        <li>
                            <input id="server_type-ec2" type="radio" name="server_type" value="ec2"{{ checked }}>
                            <label for="server_type-ec2">EC2</label>
                        </li>

                        {% set checked = form.server_type == 's3' ? ' checked' : '' %}
                        <li>
                            <input id="server_type-s3" type="radio" name="server_type" value="s3"{{ checked }}>
                            <label for="server_type-s3">S3</label>
                        </li>

                        {% set checked = form.server_type == 'cd' ? ' checked' : '' %}
                        <li>
                            <input id="server_type-cd" type="radio" name="server_type" value="cd"{{ checked }}>
                            <label for="server_type-cd">CodeDeploy</label>
                        </li>
                    </ul>
                </li>
                <li>
                    <label>Environment</label>
                    <ul class="radio-grid radio-grid--tri">
                        {% for environment in environments %}
                            {% set checked = '' %}
                            {% if form.environment == environment.id %}
                                {% set checked = ' checked="checked"' %}
                            {% endif %}

                            <li>
                                <input type="radio" name="environment" id="environment-{{ environment.id }}" value="{{ environment.id }}"{{ checked }}>
                                <label for="environment-{{ environment.id }}">{{ environment.name }}</label>
                            </li>
                        {% endfor %}
                    </ul>
                </li>

                {% set hostname = form.server_type == 'rsync' ? form.hostname : '' %}
                <li>
                    <label for="hostname">Hostname</label>
                    <input type="text" name="hostname" id="hostname" maxlength="60" value="{{ hostname }}" class="text-input">
                    <small class="additional">Rsync Servers Only</small>
                </li>

                {% set region = form.server_type != 'rsync' ? form.region : '' %}
                <li>
                    <label for="region">Region</label>
                    <input type="text" name="region" id="region" maxlength="60" value="{{ region }}" class="text-input">
                    <small class="additional">AWS Servers Only</small>
                </li>
            </ul>

            <ul class="button-list">
                <li><input class="btn btn--action" type="submit" value="Save Changes"></li>
                <li class="button-list__fixed"><a class="btn btn--secondary" href="{{ urlFor('server', {'server': server.id}) }}">Cancel</a></li>
            </ul>

        </form>
    </div>
{% endblock %}
