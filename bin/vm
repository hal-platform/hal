#!/usr/bin/env bash
ERROR=0

passthru ()
{
  sudo vagrant ssh -- "cd /vagrant; $@"
}

helper ()
{
  if [ $# -gt 0 ]; then
    echo $0: illegal option -- $@
  fi

  echo usage: $0 [-h] commands
  echo
  echo -h    Shows this helper text
  echo
  echo By default, the script changes to the virtual machine\'s /vagrant folder \(the project files\) and execute the commands specified.
  echo

  ERROR=1
}

#parse the options in the script
while getopts ":h" opt; do
  case $opt in
    h)
      helper
      ;;
    \?)
      helper $OPTARG
      ;;
  esac
done

#show the helper text if there are no arguments
if [ $# -eq 0 ]; then
  helper
fi

#run the command inside the VM if there are no errors
if [ $ERROR -eq 0 ]; then
  passthru $@
fi
