#!/usr/bin/env bash

set -e

DIR=$( cd "$( dirname "$0" )" && pwd )

COMPOSER="$DIR/composer install --prefer-dist --no-interaction --no-dev"
NPM="npm install --production"
BUNDLER="bundle install"

# Use isolated gem installation if deploying from HAL
if [ -n "$HAL_ENVIRONMENT" ]; then
    BUNDLER="bundle install --deployment  --binstubs"
fi

$COMPOSER
$NPM
$BUNDLER
