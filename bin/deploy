#!/usr/bin/env bash

set -e

DIR=$( cd "$( dirname "$0" )" && pwd )

# install and configure
"$DIR"/install
"$DIR"/config
"$DIR"/doctrine orm:generate:proxies
"$DIR"/node_modules/.bin/gulp --deploy

# Remove artifacts from deployment - keep your builds tidy!

DELFILES=(
    ".sass-cache"
    "node_modules"
    "composer"
)

# Remove files
for i in ${DELFILES[@]}
do
    FILE="$DIR/../$i"
    EXISTS=$(test -e $FILE && echo 1 || echo 0)
    if [[ $EXISTS -eq "1" ]]; then
        echo "Removing $FILE"
        rm -rf "$FILE"
    fi

done
