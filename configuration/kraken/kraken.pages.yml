services:

    ####################################################################################################################
    # CORE PAGES
    ####################################################################################################################

    kraken.applications.page:
        class: 'QL\Kraken\Controller\ApplicationsController'
        arguments:
            - @slim.request
            - @kraken.applications.twig
            - @doctrine.em
            - @session.flasher
    kraken.applications.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/applications.twig']]]

    ####################################################################################################################
    # GENERAL USE
    ####################################################################################################################

    kraken.help.page:
        parent: 'static.controller'
        arguments: [@kraken.help.twig, @slim.response]
    kraken.help.twig:
        parent: 'twig.template'
        calls: [['setTemplate', ['kraken/help.twig']]]

    ####################################################################################################################
    # ADMIN
    ####################################################################################################################

    kraken.admin.audit.logs.page:
        class: 'QL\Kraken\Controller\Admin\AuditLogsController'
        arguments:
            - @kraken.admin.audit.logs.twig
            - @doctrine.em
            - @slim.not.found
            - @slim.route.parameters
    kraken.admin.audit.logs.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/admin/audit.logs.twig']]]

    kraken.admin.audit.log.page:
        class: 'QL\Kraken\Controller\Admin\AuditLogController'
        arguments:
            - @kraken.admin.audit.log.twig
            - @kraken.auditLog
            - @doctrine.em
            - @json
    kraken.admin.audit.log.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/admin/audit.log.twig']]]

    ####################################################################################################################
    # APPLICATION
    ####################################################################################################################

    kraken.status.page:
        class: 'QL\Kraken\Controller\Application\ApplicationStatusController'
        arguments:
            - @kraken.status.twig
            - @kraken.application
            - @doctrine.em
    kraken.status.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/status.twig']]]

    kraken.application.page:
        class: 'QL\Kraken\Controller\Application\ManageApplicationController'
        arguments:
            - @kraken.application.twig
            - @kraken.application
            - @doctrine.em
    kraken.application.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/application.twig']]]


    ####################################################################################################################
    # ENVIRONMENT
    ####################################################################################################################

    kraken.environments.page:
        class: 'QL\Kraken\Controller\EnvironmentsController'
        arguments: [@kraken.environments.twig, @doctrine.em]
    kraken.environments.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/environments.twig']]]

    kraken.environment.page:
        class: 'QL\Kraken\Controller\Environment\EnvironmentController'
        arguments:
            - @kraken.environment.twig
            - @kraken.environment
            - @doctrine.em
    kraken.environment.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/environment/environment.twig']]]

    ####################################################################################################################
    # CONFIGURATION
    ####################################################################################################################

    kraken.configuration.page:
        class: 'QL\Kraken\Controller\Configuration\SnapshotController'
        arguments:
            - @kraken.configuration.twig
            - @kraken.configuration
            - @kraken.consul
            - @doctrine.em
            - @json
    kraken.configuration.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/snapshot.twig']]]

    kraken.configuration.latest.page:
        class: 'QL\Kraken\Controller\Configuration\Latest\ConfigurationController'
        arguments:
            - @kraken.configuration.latest.twig
            - @kraken.application
            - @kraken.environment
            - @doctrine.em
            - @kraken.diff
            - @slim.not.found
    kraken.configuration.latest.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/latest/configuration.twig']]]

    kraken.configuration.history.page:
        class: 'QL\Kraken\Controller\Configuration\ConfigurationHistoryController'
        arguments:
            - @kraken.configuration.history.twig
            - @kraken.application
            - @doctrine.em
            - @slim.request
            - @slim.not.found
            - @slim.route.parameters
    kraken.configuration.history.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/history.twig']]]

    kraken.configuration.compare.page:
        class: 'QL\Kraken\Controller\Configuration\CompareConfigurationController'
        arguments:
            - @kraken.configuration.compare.twig
            - @kraken.configuration
            - @doctrine.em
            - @kraken.diff
    kraken.configuration.compare.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/compare.twig']]]

    ####################################################################################################################
    # CRUD - APPLICATION
    ####################################################################################################################

    kraken.application.add.page:
        class: 'QL\Kraken\Controller\AddApplicationController'
        arguments:
            - @slim.request
            - @kraken.application.add.twig
            - @session.flasher
            - @doctrine.em
            - @kraken.validator.application
    kraken.application.add.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application.add.twig']]]

    kraken.application.target.add.page:
        class: 'QL\Kraken\Controller\Application\AddTargetController'
        arguments:
            - @slim.request
            - @kraken.application.target.add.twig
            - @kraken.application
            - @doctrine.em
            - @session.flasher
            - @kraken.random
    kraken.application.target.add.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/target.add.twig']]]

    kraken.application.edit.page:
        class: 'QL\Kraken\Controller\Application\EditApplicationController'
        arguments:
            - @slim.request
            - @kraken.application.edit.twig
            - @kraken.application
            - @session.flasher
            - @kraken.validator.application
            - @doctrine.em
    kraken.application.edit.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/application.edit.twig']]]

    kraken.application.target.edit.page:
        class: 'QL\Kraken\Controller\Application\EditTargetController'
        arguments:
            - @slim.request
            - @kraken.application.target.edit.twig
            - @kraken.target
            - @session.flasher
            - @doctrine.em
            - @kraken.acl
    kraken.application.target.edit.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/target.edit.twig']]]

    ####################################################################################################################
    # CRUD - ENVIRONMENT
    ####################################################################################################################

    kraken.environment.add.page:
        class: 'QL\Kraken\Controller\AddEnvironmentController'
        arguments:
            - @slim.request
            - @kraken.environment.add.twig
            - @session.flasher
            - @doctrine.em
            - @kraken.validator.environment
    kraken.environment.add.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/environment.add.twig']]]

    kraken.environment.edit.page:
        class: 'QL\Kraken\Controller\Environment\EditEnvironmentController'
        arguments:
            - @slim.request
            - @kraken.environment.edit.twig
            - @kraken.environment
            - @kraken.crypto.db
            - @session.flasher
            - @kraken.validator.environment
            - @doctrine.em
    kraken.environment.edit.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/environment/environment.edit.twig']]]

    kraken.environment.remove.handler:
        class: 'QL\Kraken\Controller\Environment\RemoveEnvironmentHandler'
        arguments:
            - @kraken.environment
            - @doctrine.em
            - @session.flasher

    ####################################################################################################################
    # CRUD - SCHEMA
    ####################################################################################################################

    kraken.application.schema.page:
        class: 'QL\Kraken\Controller\Application\Schema\ManageSchemaController'
        arguments:
            - @kraken.application.schema.twig
            - @kraken.application
            - @doctrine.em
    kraken.application.schema.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/schema/schema.twig']]]

    kraken.schema.add.page:
        class: 'QL\Kraken\Controller\Application\Schema\AddSchemaController'
        arguments:
            - @slim.request
            - @kraken.schema.add.twig
            - @kraken.application
            - @currentUser
            - @doctrine.em
            - @session.flasher
            - @kraken.random
    kraken.schema.add.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/schema/schema.add.twig']]]

    kraken.schema.edit.page:
        class: 'QL\Kraken\Controller\Application\Schema\EditSchemaController'
        arguments:
            - @slim.request
            - @kraken.schema.edit.twig
            - @kraken.schema
            - @doctrine.em
            - @session.flasher
    kraken.schema.edit.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/schema/schema.edit.twig']]]

    kraken.schema.remove.page:
        class: 'QL\Kraken\Controller\Application\Schema\RemoveSchemaController'
        arguments:
            - @kraken.schema.remove.twig
            - @kraken.schema
            - @doctrine.em
    kraken.schema.remove.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/application/schema/schema.remove.twig']]]

    kraken.schema.remove.handler:
        class: 'QL\Kraken\Controller\Application\Schema\RemoveSchemaHandler'
        arguments:
            - @kraken.schema
            - @doctrine.em
            - @session.flasher

    kraken.schema.skeletor.handler:
        class: 'QL\Kraken\Controller\Application\Schema\PrimeSkeletorSchemaController'
        arguments:
            - @kraken.application
            - @currentUser
            - @doctrine.em
            - @session.flasher
            - @kraken.template.skeletor

    ####################################################################################################################
    # CRUD - PROPERTY
    ####################################################################################################################

    kraken.property.page:
        class: 'QL\Kraken\Controller\Configuration\Latest\PropertyController'
        arguments:
            - @kraken.property.twig
            - @kraken.property
            - @doctrine.em
    kraken.property.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/latest/property.twig']]]

    kraken.property.add.page:
        class: 'QL\Kraken\Controller\Configuration\Latest\AddPropertyController'
        arguments:
            - @slim.request
            - @kraken.property.add.twig
            - @kraken.application
            - @kraken.environment
            - @currentUser
            - @doctrine.em
            - @session.flasher
            - @kraken.diff
            - @kraken.validator.property
            - @slim.not.found
            - @kraken.acl
    kraken.property.add.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/latest/property.add.twig']]]

    kraken.property.edit.page:
        class: 'QL\Kraken\Controller\Configuration\Latest\EditPropertyController'
        arguments:
            - @slim.request
            - @kraken.property.edit.twig
            - @kraken.property
            - @doctrine.em
            - @kraken.validator.property
            - @json
            - @session.flasher
            - @kraken.acl
    kraken.property.edit.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/latest/property.edit.twig']]]

    kraken.property.remove.page:
        class: 'QL\Kraken\Controller\Configuration\Latest\RemovePropertyController'
        arguments:
            - @kraken.property.remove.twig
            - @kraken.property
            - @doctrine.em
            - @kraken.acl
    kraken.property.remove.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/latest/property.remove.twig']]]

    kraken.property.remove.handler:
        class: 'QL\Kraken\Controller\Configuration\Latest\RemovePropertyHandler'
        arguments:
            - @kraken.property
            - @doctrine.em
            - @session.flasher
            - @kraken.acl

    ####################################################################################################################
    # DEPLOY
    ####################################################################################################################

    kraken.deploy.page:
        class: 'QL\Kraken\Controller\Configuration\DeployController'
        arguments:
            - @kraken.deploy.twig
            - @kraken.target
            - @kraken.diff
            - @kraken.acl
    kraken.deploy.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/deploy.twig']]]

    kraken.deploy.handler:
        class: 'QL\Kraken\Controller\Configuration\DeployHandler'
        arguments:
            - @doctrine.em
            - @kraken.deploy
            - @kraken.target
            - @currentUser
            - @session.flasher
            - @kraken.random
            - @kraken.acl

    kraken.rollback.page:
        class: 'QL\Kraken\Controller\Configuration\RollbackController'
        arguments:
            - @kraken.rollback.twig
            - @kraken.configuration
            - @kraken.diff
            - @session.flasher
            - @doctrine.em
            - @kraken.acl
    kraken.rollback.twig:
        parent: 'kraken.template'
        calls: [['setTemplate', ['kraken/configuration/rollback.twig']]]

    kraken.rollback.handler:
        class: 'QL\Kraken\Controller\Configuration\RollbackHandler'
        arguments:
            - @doctrine.em
            - @kraken.deploy
            - @kraken.configuration
            - @currentUser
            - @session.flasher
            - @kraken.random
            - @kraken.acl
