services:

    ####################################################################################################################
    # API Helpers
    ####################################################################################################################

    response.formatter:
        class: 'QL\Hal\Api\ResponseFormatter'
        arguments:
            - '@slim.request'
            - '@slim.response'
            - '@slim.route'
            - '@normalizer'
            - '@hypermedia.formatter'
        calls:
            - ['setCache', ['@cache']]

    hypermedia.formatter:
        class: 'QL\Hal\Api\Utility\HypermediaFormatter'
        arguments:
            - '@url'
            - '@slim.request'
            - '@slim.route'
            - '@slim.route.parameters'

    normalizer:
        class: 'QL\Hal\Api\Normalizer'
        calls:
            - ['addNormalizer', ['QL\Hal\Core\Entity\Application', '@normalizer.application']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\Build', '@normalizer.build']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\Deployment', '@normalizer.deployment']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\Environment', '@normalizer.environment']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\EventLog', '@normalizer.log.event']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\Group', '@normalizer.group']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\Push', '@normalizer.push']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\Server', '@normalizer.server']]
            - ['addNormalizer', ['QL\Hal\Core\Entity\User', '@normalizer.user']]
            - ['addNormalizer', ['MCP\DataType\Time\TimePoint', '@normalizer.timepoint']]
            - ['addNormalizer', ['QL\Hal\Api\Hyperlink', '@normalizer.hyperlink']]

    normalizer.build:
        class: 'QL\Hal\Api\Normalizer\BuildNormalizer'
        arguments:
            - '@url'
            - '@github.url_builder'
            - '@normalizer.user'
            - '@normalizer.application'
            - '@normalizer.environment'

    normalizer.deployment:
        class: 'QL\Hal\Api\Normalizer\DeploymentNormalizer'
        arguments: ['@normalizer.application', '@normalizer.server']

    normalizer.environment:
        class: 'QL\Hal\Api\Normalizer\EnvironmentNormalizer'

    normalizer.log.event:
        class: 'QL\Hal\Api\Normalizer\EventLogNormalizer'
        arguments: ['@normalizer.build', '@normalizer.push']

    normalizer.group:
        class: 'QL\Hal\Api\Normalizer\GroupNormalizer'

    normalizer.url:
        class: 'QL\Hal\Api\Normalizer\HttpUrlNormalizer'

    normalizer.push:
        class: 'QL\Hal\Api\Normalizer\PushNormalizer'
        arguments:
            - '@url'
            - '@normalizer.user'
            - '@normalizer.build'
            - '@normalizer.deployment'
            - '@normalizer.application'

    normalizer.application:
        class: 'QL\Hal\Api\Normalizer\ApplicationNormalizer'
        arguments:
            - '@url'
            - '@github.url_builder'
            - '@normalizer.group'

    normalizer.server:
        class: 'QL\Hal\Api\Normalizer\ServerNormalizer'
        arguments: ['@normalizer.environment']

    normalizer.timepoint:
        class: 'QL\Hal\Api\Normalizer\TimePointNormalizer'

    normalizer.user:
        class: 'QL\Hal\Api\Normalizer\UserNormalizer'
        arguments: ['@permissions']

    normalizer.hyperlink:
        class: 'QL\Hal\Api\Normalizer\HyperlinkNormalizer'
        arguments: ['@url']
