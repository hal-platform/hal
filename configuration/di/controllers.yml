services:

    delete.confirm.page:
        parent: 'static.controller'
        arguments: ['@delete.confirm.twig', '@slim.response']
    delete.confirm.twig:
        parent: 'twig.template'
        calls: [['setTemplate', ['delete.confirm.twig']]]

    ####################################################################################################################
    # GROUP CONTROLLERS
    ####################################################################################################################

    group.page:
        class: 'Hal\UI\Controllers\Group\GroupController'
        arguments:
            - '@group.twig'
            - '@doctrine.em'
            - '@slim.not.found'
            - '@slim.route.parameters'
    group.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['group/group.twig']]]

    group.add.page:
        class: 'Hal\UI\Controllers\Group\AddGroupController'
        arguments:
            - '@group.add.twig'
            - '@doctrine.em'
            - '@session.flasher'
            - '@slim.request'
    group.add.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['group/group.add.twig']]]

    group.edit.page:
        class: 'Hal\UI\Controllers\Group\EditGroupController'
        arguments:
            - '@group.edit.twig'
            - '@doctrine.em'
            - '@session.flasher'
            - '@slim.request'
            - '@slim.not.found'
            - '@slim.route.parameters'
    group.edit.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['group/group.edit.twig']]]
    group.remove.handler:
        class: 'Hal\UI\Controllers\Group\RemoveGroupController'
        arguments:
            - '@doctrine.em'
            - '@session.flasher'
            - '@slim.not.found'
            - '@slim.route.parameters'

    ####################################################################################################################
    # USER CONTROLLERS
    ####################################################################################################################

    user.page:
        class: 'Hal\UI\Controllers\User\UserController'
        arguments:
            - '@user.twig'
            - '@hal.user'
            - '@doctrine.em'
            - '@permissions'
            - '@json'
        calls:
            - ['setCache', ['@cache']]
            - ['setCacheTTL', ['%cache.page.ttl%']]
    user.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['user/user.twig']]]

    users.page:
        class: 'Hal\UI\Controllers\User\UsersController'
        arguments: ['@users.twig', '@doctrine.em']
    users.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['user/users.twig']]]

    user.settings.page:
        class: 'Hal\UI\Controllers\User\SettingsController'
        arguments: ['@user.settings.twig', '@currentUser']
    user.settings.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['user/settings.twig']]]

    user.settings.handler:
        class: 'Hal\UI\Controllers\User\SettingsHandler'
        arguments:
            - '@slim.cookies'
            - '@session.flasher'
            - '@slim.request'
            - '%cookie.preferences.ttl%'

    user.disable.handler:
        class: 'Hal\UI\Controllers\User\DisableUserHandler'
        arguments:
            - '@doctrine.em'
            - '@permissions'
            - '@session.flasher'
            - '@hal.user'

    user.enable.handler:
        class: 'Hal\UI\Controllers\User\EnableUserHandler'
        arguments:
            - '@doctrine.em'
            - '@session.flasher'
            - '@hal.user'

    ####################################################################################################################
    # USER TOKEN MANAGEMENT CONTROLLERS
    ####################################################################################################################

    user.token.add.handler:
        class: 'Hal\UI\Controllers\User\Token\AddTokenController'
        arguments:
            - '@doctrine.em'
            - '@permissions'
            - '@currentUser'
            - '@session.flasher'
            - '@slim.request'
            - '@slim.not.found'
            - '@doctrine.random'
            - '@slim.route.parameters'

    user.token.remove.handler:
        class: 'Hal\UI\Controllers\User\Token\RemoveTokenController'
        arguments:
            - '@doctrine.em'
            - '@permissions'
            - '@currentUser'
            - '@session.flasher'
            - '@slim.not.found'
            - '@slim.route.parameters'

    ####################################################################################################################
    # GITHUB OAUTH CONTROLLERS
    ####################################################################################################################

    github.authorization.page:
        class: 'Hal\UI\Controllers\OAuth\GithubCallbackController'
        arguments:
            - '@github.authorization.twig'
            - '@slim.request'
            - '@doctrine.em'
            - '@currentUser'
            - '@github.oauth'
            - '@session'
            - '@url'
    github.authorization.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['user/github.token.error.twig']]]

    github.authorization.remove.page:
        class: 'Hal\UI\Controllers\User\RemoveGithubTokenController'
        arguments:
            - '@github.authorization.remove.twig'
            - '@slim.request'
            - '@doctrine.em'
            - '@currentUser'
            - '@github.oauth'
            - '@session'
            - '@url'
    github.authorization.remove.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['user/github.token.remove.twig']]]

