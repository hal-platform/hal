services:
    ####################################################################################################################
    # ADMIN CONTROLLERS
    ####################################################################################################################

    admin.dashboard.page:
        class: 'QL\Hal\Controllers\Admin\DashboardController'
        arguments:
            - @admin.dashboard.twig
            - %cookie.encryption.secret%
            - %session.encryption.secret%
            - @hal.pushfile.path
    admin.dashboard.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/dashboard.twig']]]

    admin.audit.logs.page:
        class: 'QL\Hal\Controllers\Admin\AuditLogsController'
        arguments:
            - @admin.audit.logs.twig
            - @doctrine.em
            - @slim.not.found
            - @slim.route.parameters
    admin.audit.logs.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/audit.logs.twig']]]

    admin.system.status.page:
        class: 'QL\Hal\Controllers\Admin\SystemStatusController'
        arguments:
            - @admin.system.status.twig
            - @doctrine.em
            - @redis
            - @json
            - @slim.not.found
            - %hal.agents%
            - @slim.route.parameters
    admin.system.status.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/system.status.twig']]]

    ####################################################################################################################
    # PERMISSION CONTROLLERS
    ####################################################################################################################

    admin.permissions.page:
        class: 'QL\Hal\Controllers\Admin\Permissions\PermissionsController'
        arguments:
            - @admin.permissions.twig
            - @currentUser
            - @doctrine.em
    admin.permissions.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/permissions/permissions.twig']]]

    admin.permissions.deployment.page:
        class: 'QL\Hal\Controllers\Admin\Permissions\DeploymentPermissionsController'
        arguments:
            - @admin.permissions.deployment.twig
            - @currentUser
            - @doctrine.em
    admin.permissions.deployment.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/permissions/deployments.twig']]]

    admin.permissions.remove.page:
        class: 'QL\Hal\Controllers\Admin\Permissions\RemovePermissionsController'
        arguments:
            - @admin.permissions.remove.twig
            - @currentUser
            - @hal.userType
            - @permissions
            - @session.flasher
    admin.permissions.remove.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/permissions/permission.remove.twig']]]

    admin.permissions.remove.handler:
        class: 'QL\Hal\Controllers\Admin\Permissions\RemovePermissionsHandler'
        arguments:
            - @currentUser
            - @hal.userType
            - @permissions
            - @session.flasher

    admin.permissions.add.page:
        class: 'QL\Hal\Controllers\Admin\Permissions\AddPermissionsController'
        arguments:
            - @slim.request
            - @admin.permissions.add.twig
            - @currentUser
            - @hal.user
            - @doctrine.em
            - @permissions
            - @json
            - @session.flasher
            - @doctrine.random
        calls:
            - ['setCache', [@cache]]
            - ['setCacheTTL', [%cache.page.ttl%]]
    admin.permissions.add.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/permissions/permission.add.twig']]]

    admin.permissions.deployment.remove.page:
        class: 'QL\Hal\Controllers\Admin\Permissions\RemoveDeploymentPermissionsController'
        arguments:
            - @admin.permissions.deployment.remove.twig
            - @hal.userPermission
            - @permissions
    admin.permissions.deployment.remove.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/permissions/deployment.remove.twig']]]

    admin.permissions.deployment.remove.handler:
        class: 'QL\Hal\Controllers\Admin\Permissions\RemoveDeploymentPermissionsHandler'
        arguments:
            - @hal.userPermission
            - @permissions
            - @session.flasher

    admin.permissions.refresh.handler:
        class: 'QL\Hal\Controllers\Admin\Permissions\RefreshUserPermissionsController'
        arguments:
            - @hal.user
            - @permissions
            - @session.flasher

    ####################################################################################################################
    # SUPER ADMIN CONTROLLERS
    ####################################################################################################################

    admin.users.page:
        class: 'QL\Hal\Controllers\Admin\Super\UserManagementController'
        arguments:
            - @admin.users.twig
            - @ldap
            - @doctrine.em
            - @slim.request
    admin.users.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/users.management.twig']]]

    admin.caches.page:
        class: 'QL\Hal\Controllers\Admin\Super\CacheManagementController'
        arguments:
            - @admin.caches.twig
            - @redis
            - @root
    admin.caches.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/cache.management.twig']]]

    admin.caches.handler:
        class: 'QL\Hal\Controllers\Admin\Super\CacheManagementHandler'
        arguments:
            - @slim.request
            - @session
            - @url
            - @doctrine.config
            - @redis

    admin.message.page:
        class: 'QL\Hal\Controllers\Admin\Super\GlobalMessageController'
        arguments:
            - @admin.message.twig
            - @global.message
            - @session.flasher
            - @slim.request
    admin.message.twig:
        parent: 'twig.auto.template'
        calls: [['setTemplate', ['admin/global.message.twig']]]
